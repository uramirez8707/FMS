<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>FMS: Building with Autotools</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">FMS
   &#160;<span id="projectnumber">2022.03.0-dev</span>
   </div>
   <div id="projectbrief">Flexible Modeling System</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('autotools.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Building with Autotools </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1>Autotools Build System Documentation</h1>
<p>This document describes the autotools-based build system for FMS.</p>
<h2>Introduction to Autotools</h2>
<p>Autoconf, automake, and libtool and the GNU/Linux standard build tools. When building a package based on autotools, the user does something like:</p>
<p>./configure &amp;&amp; make check install</p>
<p>The configure step queries the system about many things, and contructs makefiles.</p>
<p>The make step uses the generated Makefiles to build, test, and install the software.</p>
<p>Standard environment variables and configure options can be used to control many aspects of the build. Custom configure options can easily be added to support additional needs.</p>
<h3>Caution Concerning Generated Files</h3>
<p>Autotools creates many generated files, which should not be edited or checked into the repository. Simply ignore them. Do not try to edit generated Makefiles, do not move or rename any of the shell scripts that autoreconf puts in place to let autotools work. These files have been added to .gitignore and should never be added to the repo.</p>
<h1>How to Build FMS</h1>
<p>Previously, everyone built FMS by checking out code from git. However, with the new build system, only those who want to contribute to the code base need check out the code from git.</p>
<h2>As an FMS Developer</h2>
<p>All FMS developers will need a reasobably reacent version of tools autoconf, automake, and libtool. These are available on package management systems. (Ex. yum install automake autoconf libtool).</p>
<p>The process of building FMS from the repo is:</p>
<ol type="1">
<li>Clone repo and cd into repo directory.</li>
<li>Run autoreconf -i to build the developer build system.</li>
<li>Run ./configure to configure.</li>
<li>Run make to build.</li>
</ol>
<h2>As an FMS User</h2>
<p>Users start with a tarball, not the git repo. They do not have to have any of the autotools installed. Thier build process is:</p>
<ol type="1">
<li>Unpack the tarball and cd into the directory.</li>
<li>Run ./configure &ndash;prefix=/my/installdir</li>
<li>Run make install</li>
</ol>
<h2>Precious Flags for configure</h2>
<p>Some environment variables are important to the autotools build system, these are known as "precious" variables. One example is CC, which should be set to the C compiler.</p>
<p>It's common to set some precious vars before the build. Commonly used ones include:</p><ul>
<li>CC the C compiler</li>
<li>FC the Fortran compiler</li>
<li>CPPFLAGS C (and Fortran) pre-processor flags</li>
<li>FCFLAGS Fortran compiler flags</li>
<li>LDFLAGS Linker flags</li>
</ul>
<h2>Standard Configure Options</h2>
<p>The configure script has some standard options, including:</p><ul>
<li>&ndash;prefix allows user to specify install directory</li>
<li>&ndash;disable-shared disables building of shared library</li>
<li>&ndash;help prints message showing all options</li>
</ul>
<h2>FMS Configure Options</h2>
<p>Configure build options for FMS:</p><ul>
<li><code>--with-yaml</code> : Build with support for yaml input files(requires the libyaml library and headers)</li>
<li><code>--enable-mixed-mode</code> : Build in mixed precision mode, with default 4 byte reals and 8 byte real overloads</li>
<li><code>--disable-setting-flags</code> : Build without automatically setting flags during configuration</li>
<li><code>--with-mpi</code> : Build with MPI support, enabled by default</li>
</ul>
<h2>Standard Make Targets</h2>
<p>Some of the useful make targets include:</p><ul>
<li>make or make all - build code</li>
<li>make install - build code (as needed) and install</li>
<li>make check - build code (as needed) and run tests</li>
<li>make clean - clean back build</li>
<li>make distclean - clean configure output and build</li>
<li>make dist - create a tarball for distribution</li>
<li>make distcheck - create a tarball, unpack it, build and run tests, then then clean it. </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="build.html">Building and Installation</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
