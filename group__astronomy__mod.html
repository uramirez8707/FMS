<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>FMS: astronomy_mod</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">FMS
   &#160;<span id="projectnumber">2022.01.0-dev</span>
   </div>
   <div id="projectbrief">Flexible Modeling System</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('group__astronomy__mod.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Types</a> &#124;
<a href="#func-members">Functions/Subroutines</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">astronomy_mod<div class="ingroups"><a class="el" href="group__astronomy.html">Astronomy</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Provides astronomical variables for use by other modules within fms. The only currently used interface is for determination of astronomical values needed by the shortwave radiation packages.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Types</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">interface &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfaceastronomy__mod_1_1diurnal__solar.html">diurnal_solar</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates solar information for the given location(lat &amp; lon) and time.  <a href="interfaceastronomy__mod_1_1diurnal__solar.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">interface &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfaceastronomy__mod_1_1daily__mean__solar.html">daily_mean_solar</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the daily mean solar information for a given time and latitude.  <a href="interfaceastronomy__mod_1_1daily__mean__solar.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">interface &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfaceastronomy__mod_1_1annual__mean__solar.html">annual_mean_solar</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the annual mean of solar information for a given latitude and time.  <a href="interfaceastronomy__mod_1_1annual__mean__solar.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">interface &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfaceastronomy__mod_1_1get__period.html">get_period</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the length of year for current calendar.  <a href="interfaceastronomy__mod_1_1get__period.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">interface &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfaceastronomy__mod_1_1set__period.html">set_period</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the length of a year for the calendar in use.  <a href="interfaceastronomy__mod_1_1set__period.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">interface &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfaceastronomy__mod_1_1half__day.html">half_day</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Private interface for internal use by dirunal_solar and <a class="el" href="interfaceastronomy__mod_1_1daily__mean__solar.html" title="Calculates the daily mean solar information for a given time and latitude.">daily_mean_solar</a>.  <a href="interfaceastronomy__mod_1_1half__day.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:ga28a67f4da82725afd9c0051464b8767c"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__astronomy__mod.html#ga28a67f4da82725afd9c0051464b8767c">astronomy_init</a> (latb, lonb)</td></tr>
<tr class="memdesc:ga28a67f4da82725afd9c0051464b8767c"><td class="mdescLeft">&#160;</td><td class="mdescRight">astronomy_init is the constructor for astronomy_mod.  <a href="group__astronomy__mod.html#ga28a67f4da82725afd9c0051464b8767c">More...</a><br /></td></tr>
<tr class="separator:ga28a67f4da82725afd9c0051464b8767c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae2cdd8e2fb16d2d09083ef51fd9fa5f6"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__astronomy__mod.html#gae2cdd8e2fb16d2d09083ef51fd9fa5f6">get_period_integer</a> (period_out)</td></tr>
<tr class="memdesc:gae2cdd8e2fb16d2d09083ef51fd9fa5f6"><td class="mdescLeft">&#160;</td><td class="mdescRight">get_period_integer returns the length of the year as an integer number of seconds.  <a href="group__astronomy__mod.html#gae2cdd8e2fb16d2d09083ef51fd9fa5f6">More...</a><br /></td></tr>
<tr class="separator:gae2cdd8e2fb16d2d09083ef51fd9fa5f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gadc97a16dbd669dfb2ba2b36daaf34b79"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__astronomy__mod.html#gadc97a16dbd669dfb2ba2b36daaf34b79">get_period_time_type</a> (period_out)</td></tr>
<tr class="memdesc:gadc97a16dbd669dfb2ba2b36daaf34b79"><td class="mdescLeft">&#160;</td><td class="mdescRight">get_period_time_type returns the length of the year as a time_type variable.  <a href="group__astronomy__mod.html#gadc97a16dbd669dfb2ba2b36daaf34b79">More...</a><br /></td></tr>
<tr class="separator:gadc97a16dbd669dfb2ba2b36daaf34b79"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab0623c3af659b6b2bea0f17132597d9b"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__astronomy__mod.html#gab0623c3af659b6b2bea0f17132597d9b">set_period_integer</a> (period_in)</td></tr>
<tr class="memdesc:gab0623c3af659b6b2bea0f17132597d9b"><td class="mdescLeft">&#160;</td><td class="mdescRight">set_period_integer saves as the input length of the year (an integer) in a time_type module variable.  <a href="group__astronomy__mod.html#gab0623c3af659b6b2bea0f17132597d9b">More...</a><br /></td></tr>
<tr class="separator:gab0623c3af659b6b2bea0f17132597d9b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga77dfe2d27540f0298b3e559c1f4a7a98"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__astronomy__mod.html#ga77dfe2d27540f0298b3e559c1f4a7a98">set_period_time_type</a> (period_in)</td></tr>
<tr class="memdesc:ga77dfe2d27540f0298b3e559c1f4a7a98"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set_period_time_type saves the length of the year (input as a time_type variable) into a time_type module variable.  <a href="group__astronomy__mod.html#ga77dfe2d27540f0298b3e559c1f4a7a98">More...</a><br /></td></tr>
<tr class="separator:ga77dfe2d27540f0298b3e559c1f4a7a98"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga58ff2b69c33ae8d00c831b2b049e4573"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__astronomy__mod.html#ga58ff2b69c33ae8d00c831b2b049e4573">set_orbital_parameters</a> (ecc_in, obliq_in, per_in)</td></tr>
<tr class="memdesc:ga58ff2b69c33ae8d00c831b2b049e4573"><td class="mdescLeft">&#160;</td><td class="mdescRight">set_orbital_parameters saves the input values of eccentricity, obliquity and perihelion time as module variables for use by astronomy_mod.  <a href="group__astronomy__mod.html#ga58ff2b69c33ae8d00c831b2b049e4573">More...</a><br /></td></tr>
<tr class="separator:ga58ff2b69c33ae8d00c831b2b049e4573"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3878ea3f081f4d89f7f19bd530767897"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__astronomy__mod.html#ga3878ea3f081f4d89f7f19bd530767897">get_orbital_parameters</a> (ecc_out, obliq_out, per_out)</td></tr>
<tr class="memdesc:ga3878ea3f081f4d89f7f19bd530767897"><td class="mdescLeft">&#160;</td><td class="mdescRight">get_orbital_parameters retrieves the orbital parameters for use by another module.  <a href="group__astronomy__mod.html#ga3878ea3f081f4d89f7f19bd530767897">More...</a><br /></td></tr>
<tr class="separator:ga3878ea3f081f4d89f7f19bd530767897"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga58c5837e3f38565db2c7901d880950f7"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__astronomy__mod.html#ga58c5837e3f38565db2c7901d880950f7">set_ref_date_of_ae</a> (day_in, month_in, year_in, second_in, minute_in, hour_in)</td></tr>
<tr class="memdesc:ga58c5837e3f38565db2c7901d880950f7"><td class="mdescLeft">&#160;</td><td class="mdescRight">set_ref_date_of_ae provides a means of specifying the reference date of the NH autumnal equinox for a particular year.  <a href="group__astronomy__mod.html#ga58c5837e3f38565db2c7901d880950f7">More...</a><br /></td></tr>
<tr class="separator:ga58c5837e3f38565db2c7901d880950f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gada396fa1ede7431df75438a6c9d6c771"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__astronomy__mod.html#gada396fa1ede7431df75438a6c9d6c771">get_ref_date_of_ae</a> (day_out, month_out, year_out, second_out, minute_out, hour_out)</td></tr>
<tr class="memdesc:gada396fa1ede7431df75438a6c9d6c771"><td class="mdescLeft">&#160;</td><td class="mdescRight">get_ref_date_of_ae retrieves the reference date of the autumnal equinox as integer variables.  <a href="group__astronomy__mod.html#gada396fa1ede7431df75438a6c9d6c771">More...</a><br /></td></tr>
<tr class="separator:gada396fa1ede7431df75438a6c9d6c771"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8a9bd207af7b8495bb6768ab44b5a3f6"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__astronomy__mod.html#ga8a9bd207af7b8495bb6768ab44b5a3f6">diurnal_solar_2d</a> (lat, lon, gmt, time_since_ae, cosz, fracday, rrsun, dt, allow_negative_cosz, half_day_out)</td></tr>
<tr class="memdesc:ga8a9bd207af7b8495bb6768ab44b5a3f6"><td class="mdescLeft">&#160;</td><td class="mdescRight">diurnal_solar_2d returns 2d fields of cosine of zenith angle, daylight fraction and earth-sun distance at the specified latitudes, longitudes and time. These values may be instantaneous or averaged over a specified time interval.  <a href="group__astronomy__mod.html#ga8a9bd207af7b8495bb6768ab44b5a3f6">More...</a><br /></td></tr>
<tr class="separator:ga8a9bd207af7b8495bb6768ab44b5a3f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga092642be4e355e43086c904d9fcb8d39"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__astronomy__mod.html#ga092642be4e355e43086c904d9fcb8d39">diurnal_solar_1d</a> (lat, lon, gmt, time_since_ae, cosz, fracday, rrsun, dt, allow_negative_cosz, half_day_out)</td></tr>
<tr class="memdesc:ga092642be4e355e43086c904d9fcb8d39"><td class="mdescLeft">&#160;</td><td class="mdescRight">diurnal_solar_1d takes 1-d input fields, adds a second dimension and calls diurnal_solar_2d. on return, the 2d fields are returned to the original 1d fields.  <a href="group__astronomy__mod.html#ga092642be4e355e43086c904d9fcb8d39">More...</a><br /></td></tr>
<tr class="separator:ga092642be4e355e43086c904d9fcb8d39"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga54ac46fdf8eb5cf66f27c8995ce017da"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__astronomy__mod.html#ga54ac46fdf8eb5cf66f27c8995ce017da">diurnal_solar_0d</a> (lat, lon, gmt, time_since_ae, cosz, fracday, rrsun, dt, allow_negative_cosz, half_day_out)</td></tr>
<tr class="memdesc:ga54ac46fdf8eb5cf66f27c8995ce017da"><td class="mdescLeft">&#160;</td><td class="mdescRight">diurnal_solar_0d takes scalar input fields, makes them into 2d arrays dimensioned (1,1), and calls diurnal_solar_2d. on return, the 2d fields are converted back to the desired scalar output.  <a href="group__astronomy__mod.html#ga54ac46fdf8eb5cf66f27c8995ce017da">More...</a><br /></td></tr>
<tr class="separator:ga54ac46fdf8eb5cf66f27c8995ce017da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6bc8afe25709ff957b1e3a6fa5c33a8d"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__astronomy__mod.html#ga6bc8afe25709ff957b1e3a6fa5c33a8d">diurnal_solar_cal_2d</a> (lat, lon, time, cosz, fracday, rrsun, dt_time, allow_negative_cosz, half_day_out)</td></tr>
<tr class="memdesc:ga6bc8afe25709ff957b1e3a6fa5c33a8d"><td class="mdescLeft">&#160;</td><td class="mdescRight">diurnal_solar_cal_2d receives time_type inputs, converts them to real variables and then calls diurnal_solar_2d to compute desired astronomical variables.  <a href="group__astronomy__mod.html#ga6bc8afe25709ff957b1e3a6fa5c33a8d">More...</a><br /></td></tr>
<tr class="separator:ga6bc8afe25709ff957b1e3a6fa5c33a8d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga42d49be6db81f5ab9e4974b523f52dae"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__astronomy__mod.html#ga42d49be6db81f5ab9e4974b523f52dae">diurnal_solar_cal_1d</a> (lat, lon, time, cosz, fracday, rrsun, dt_time, allow_negative_cosz, half_day_out)</td></tr>
<tr class="memdesc:ga42d49be6db81f5ab9e4974b523f52dae"><td class="mdescLeft">&#160;</td><td class="mdescRight">diurnal_solar_cal_1d receives time_type inputs, converts them to real variables and then calls diurnal_solar_2d to compute desired astronomical variables.  <a href="group__astronomy__mod.html#ga42d49be6db81f5ab9e4974b523f52dae">More...</a><br /></td></tr>
<tr class="separator:ga42d49be6db81f5ab9e4974b523f52dae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae1cf91fe03ba0c23f228d6f3495e4068"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__astronomy__mod.html#gae1cf91fe03ba0c23f228d6f3495e4068">diurnal_solar_cal_0d</a> (lat, lon, time, cosz, fracday, rrsun, dt_time, allow_negative_cosz, half_day_out)</td></tr>
<tr class="memdesc:gae1cf91fe03ba0c23f228d6f3495e4068"><td class="mdescLeft">&#160;</td><td class="mdescRight">diurnal_solar_cal_0d receives time_type inputs, converts them to real variables and then calls diurnal_solar_2d to compute desired astronomical variables.  <a href="group__astronomy__mod.html#gae1cf91fe03ba0c23f228d6f3495e4068">More...</a><br /></td></tr>
<tr class="separator:gae1cf91fe03ba0c23f228d6f3495e4068"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga699784bad69d4edfa2551c303acd875c"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__astronomy__mod.html#ga699784bad69d4edfa2551c303acd875c">daily_mean_solar_2d</a> (lat, time_since_ae, cosz, h_out, rr_out)</td></tr>
<tr class="memdesc:ga699784bad69d4edfa2551c303acd875c"><td class="mdescLeft">&#160;</td><td class="mdescRight">daily_mean_solar_2d computes the daily mean astronomical parameters for the input points at latitude lat and time of year time_since_ae.  <a href="group__astronomy__mod.html#ga699784bad69d4edfa2551c303acd875c">More...</a><br /></td></tr>
<tr class="separator:ga699784bad69d4edfa2551c303acd875c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad097b3db07240f4b90b2a34942960f62"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__astronomy__mod.html#gad097b3db07240f4b90b2a34942960f62">daily_mean_solar_1d</a> (lat, time_since_ae, cosz, h_out, rr_out)</td></tr>
<tr class="memdesc:gad097b3db07240f4b90b2a34942960f62"><td class="mdescLeft">&#160;</td><td class="mdescRight">daily_mean_solar_1d takes 1-d input fields, adds a second dimension and calls daily_mean_solar_2d. on return, the 2d fields are returned to the original 1d fields.  <a href="group__astronomy__mod.html#gad097b3db07240f4b90b2a34942960f62">More...</a><br /></td></tr>
<tr class="separator:gad097b3db07240f4b90b2a34942960f62"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga796094232cd50abc686b52548b3c3b2a"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__astronomy__mod.html#ga796094232cd50abc686b52548b3c3b2a">daily_mean_solar_2level</a> (lat, time_since_ae, cosz, solar)</td></tr>
<tr class="memdesc:ga796094232cd50abc686b52548b3c3b2a"><td class="mdescLeft">&#160;</td><td class="mdescRight">daily_mean_solar_2level takes 1-d input fields, adds a second dimension and calls daily_mean_solar_2d. on return, the 2d fields are returned to the original 1d fields.  <a href="group__astronomy__mod.html#ga796094232cd50abc686b52548b3c3b2a">More...</a><br /></td></tr>
<tr class="separator:ga796094232cd50abc686b52548b3c3b2a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5a5756a118e2a409d64a7958bc923af2"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__astronomy__mod.html#ga5a5756a118e2a409d64a7958bc923af2">daily_mean_solar_0d</a> (lat, time_since_ae, cosz, h_out, rr_out)</td></tr>
<tr class="memdesc:ga5a5756a118e2a409d64a7958bc923af2"><td class="mdescLeft">&#160;</td><td class="mdescRight">daily_mean_solar_1d takes 1-d input fields, adds a second dimension and calls daily_mean_solar_2d. on return, the 2d fields are returned to the original 1d fields.  <a href="group__astronomy__mod.html#ga5a5756a118e2a409d64a7958bc923af2">More...</a><br /></td></tr>
<tr class="separator:ga5a5756a118e2a409d64a7958bc923af2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf6094e628e630913842bcb468f8d39a2"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__astronomy__mod.html#gaf6094e628e630913842bcb468f8d39a2">daily_mean_solar_cal_2d</a> (lat, time, cosz, fracday, rrsun)</td></tr>
<tr class="memdesc:gaf6094e628e630913842bcb468f8d39a2"><td class="mdescLeft">&#160;</td><td class="mdescRight">daily_mean_solar_cal_2d receives time_type inputs, converts them to real variables and then calls daily_mean_solar_2d to compute desired astronomical variables.  <a href="group__astronomy__mod.html#gaf6094e628e630913842bcb468f8d39a2">More...</a><br /></td></tr>
<tr class="separator:gaf6094e628e630913842bcb468f8d39a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6a985f1ba0f71868c80cd95b9f4de668"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__astronomy__mod.html#ga6a985f1ba0f71868c80cd95b9f4de668">daily_mean_solar_cal_1d</a> (lat, time, cosz, fracday, rrsun)</td></tr>
<tr class="memdesc:ga6a985f1ba0f71868c80cd95b9f4de668"><td class="mdescLeft">&#160;</td><td class="mdescRight">daily_mean_solar_cal_1d receives time_type inputs, converts them to real, 2d variables and then calls daily_mean_solar_2d to compute desired astronomical variables.  <a href="group__astronomy__mod.html#ga6a985f1ba0f71868c80cd95b9f4de668">More...</a><br /></td></tr>
<tr class="separator:ga6a985f1ba0f71868c80cd95b9f4de668"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab81094cd66751b014bb2179d6d3667b6"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__astronomy__mod.html#gab81094cd66751b014bb2179d6d3667b6">daily_mean_solar_cal_2level</a> (lat, time, cosz, solar)</td></tr>
<tr class="memdesc:gab81094cd66751b014bb2179d6d3667b6"><td class="mdescLeft">&#160;</td><td class="mdescRight">daily_mean_solar_cal_2level receives 1d arrays and time_type input, converts them to real, 2d variables and then calls daily_mean_solar_2d to compute desired astronomical variables.  <a href="group__astronomy__mod.html#gab81094cd66751b014bb2179d6d3667b6">More...</a><br /></td></tr>
<tr class="separator:gab81094cd66751b014bb2179d6d3667b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga42ef874f203c88171bef1573c9f96c73"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__astronomy__mod.html#ga42ef874f203c88171bef1573c9f96c73">daily_mean_solar_cal_0d</a> (lat, time, cosz, fracday, rrsun)</td></tr>
<tr class="memdesc:ga42ef874f203c88171bef1573c9f96c73"><td class="mdescLeft">&#160;</td><td class="mdescRight">daily_mean_solar_cal_0d converts scalar input fields to real, 2d variables and then calls daily_mean_solar_2d to compute desired astronomical variables.  <a href="group__astronomy__mod.html#ga42ef874f203c88171bef1573c9f96c73">More...</a><br /></td></tr>
<tr class="separator:ga42ef874f203c88171bef1573c9f96c73"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab7f32b9b56f90b2506caa6792a5b4061"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__astronomy__mod.html#gab7f32b9b56f90b2506caa6792a5b4061">annual_mean_solar_2d</a> (js, je, lat, cosz, solar, fracday, rrsun)</td></tr>
<tr class="memdesc:gab7f32b9b56f90b2506caa6792a5b4061"><td class="mdescLeft">&#160;</td><td class="mdescRight">annual_mean_solar_2d returns 2d fields of annual mean values of the cosine of zenith angle, daylight fraction and earth-sun distance at the specified latitude.  <a href="group__astronomy__mod.html#gab7f32b9b56f90b2506caa6792a5b4061">More...</a><br /></td></tr>
<tr class="separator:gab7f32b9b56f90b2506caa6792a5b4061"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5d8127b604bbddae17c0d2d658d2a715"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__astronomy__mod.html#ga5d8127b604bbddae17c0d2d658d2a715">annual_mean_solar_1d</a> (jst, jnd, lat, cosz, solar, fracday, rrsun_out)</td></tr>
<tr class="memdesc:ga5d8127b604bbddae17c0d2d658d2a715"><td class="mdescLeft">&#160;</td><td class="mdescRight">annual_mean_solar_1d creates 2-d input fields from 1-d input fields and then calls annual_mean_solar_2d to obtain 2-d output fields which are then stored into 1-d fields for return to the calling subroutine.  <a href="group__astronomy__mod.html#ga5d8127b604bbddae17c0d2d658d2a715">More...</a><br /></td></tr>
<tr class="separator:ga5d8127b604bbddae17c0d2d658d2a715"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad63eb1838f8bd3a04f7323a0dc826c83"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__astronomy__mod.html#gad63eb1838f8bd3a04f7323a0dc826c83">annual_mean_solar_2level</a> (lat, cosz, solar)</td></tr>
<tr class="memdesc:gad63eb1838f8bd3a04f7323a0dc826c83"><td class="mdescLeft">&#160;</td><td class="mdescRight">annual_mean_solar_2level creates 2-d input fields from 1-d input fields and then calls annual_mean_solar_2d to obtain 2-d output fields which are then stored into 1-d fields for return to the calling subroutine. This subroutine will be called during model initialization.  <a href="group__astronomy__mod.html#gad63eb1838f8bd3a04f7323a0dc826c83">More...</a><br /></td></tr>
<tr class="separator:gad63eb1838f8bd3a04f7323a0dc826c83"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1cbb745900e141cfee7e422a2f02caa1"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__astronomy__mod.html#ga1cbb745900e141cfee7e422a2f02caa1">astronomy_end</a></td></tr>
<tr class="memdesc:ga1cbb745900e141cfee7e422a2f02caa1"><td class="mdescLeft">&#160;</td><td class="mdescRight">astronomy_end is the destructor for astronomy_mod.  <a href="group__astronomy__mod.html#ga1cbb745900e141cfee7e422a2f02caa1">More...</a><br /></td></tr>
<tr class="separator:ga1cbb745900e141cfee7e422a2f02caa1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8dccd51b88c5f26258bcaab0b250675d"><td class="memItemLeft" align="right" valign="top">subroutine, private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__astronomy__mod.html#ga8dccd51b88c5f26258bcaab0b250675d">orbit</a></td></tr>
<tr class="memdesc:ga8dccd51b88c5f26258bcaab0b250675d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Orbit computes and stores a table of value of orbital angles as a function of orbital time (both the angle and time are zero at autumnal equinox in the NH, and range from 0 to 2*pi).  <a href="group__astronomy__mod.html#ga8dccd51b88c5f26258bcaab0b250675d">More...</a><br /></td></tr>
<tr class="separator:ga8dccd51b88c5f26258bcaab0b250675d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga527ff37a27810731b3515a0351ffd8a5"><td class="memItemLeft" align="right" valign="top">real function, private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__astronomy__mod.html#ga527ff37a27810731b3515a0351ffd8a5">r_inv_squared</a> (ang)</td></tr>
<tr class="memdesc:ga527ff37a27810731b3515a0351ffd8a5"><td class="mdescLeft">&#160;</td><td class="mdescRight">r_inv_squared returns the inverse of the square of the earth-sun distance relative to the mean distance at angle ang in the Earth's orbit.  <a href="group__astronomy__mod.html#ga527ff37a27810731b3515a0351ffd8a5">More...</a><br /></td></tr>
<tr class="separator:ga527ff37a27810731b3515a0351ffd8a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae7804247bd90b8bed01d7769a609f81d"><td class="memItemLeft" align="right" valign="top">real function, private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__astronomy__mod.html#gae7804247bd90b8bed01d7769a609f81d">angle</a> (t)</td></tr>
<tr class="memdesc:gae7804247bd90b8bed01d7769a609f81d"><td class="mdescLeft">&#160;</td><td class="mdescRight">angle determines the position within the earth's orbit at time t in the year (t = 0 at NH autumnal equinox) by interpolating into the orbital position table.  <a href="group__astronomy__mod.html#gae7804247bd90b8bed01d7769a609f81d">More...</a><br /></td></tr>
<tr class="separator:gae7804247bd90b8bed01d7769a609f81d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4161170ad847a225cb01bee3f3a29041"><td class="memItemLeft" align="right" valign="top">real function, private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__astronomy__mod.html#ga4161170ad847a225cb01bee3f3a29041">declination</a> (ang)</td></tr>
<tr class="memdesc:ga4161170ad847a225cb01bee3f3a29041"><td class="mdescLeft">&#160;</td><td class="mdescRight">Declination returns the solar declination angle at orbital position ang in earth's orbit.  <a href="group__astronomy__mod.html#ga4161170ad847a225cb01bee3f3a29041">More...</a><br /></td></tr>
<tr class="separator:ga4161170ad847a225cb01bee3f3a29041"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga47f0a2733fe061cf8f54e0a13256e42c"><td class="memItemLeft" align="right" valign="top">real function, dimension(size(latitude, 1), size(latitude, 2))&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__astronomy__mod.html#ga47f0a2733fe061cf8f54e0a13256e42c">half_day_2d</a> (latitude, dec)</td></tr>
<tr class="memdesc:ga47f0a2733fe061cf8f54e0a13256e42c"><td class="mdescLeft">&#160;</td><td class="mdescRight">half_day_2d returns a 2-d array of half-day lengths at the latitudes and declination provided.  <a href="group__astronomy__mod.html#ga47f0a2733fe061cf8f54e0a13256e42c">More...</a><br /></td></tr>
<tr class="separator:ga47f0a2733fe061cf8f54e0a13256e42c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3257c2c989c28308991a0eace3d38e69"><td class="memItemLeft" align="right" valign="top">real function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__astronomy__mod.html#ga3257c2c989c28308991a0eace3d38e69">half_day_0d</a> (latitude, dec)</td></tr>
<tr class="memdesc:ga3257c2c989c28308991a0eace3d38e69"><td class="mdescLeft">&#160;</td><td class="mdescRight">half_day_0d takes scalar input fields, makes them into 2-d fields dimensioned (1,1), and calls half_day_2d. On return, the 2-d fields are converted to the desired scalar output.  <a href="group__astronomy__mod.html#ga3257c2c989c28308991a0eace3d38e69">More...</a><br /></td></tr>
<tr class="separator:ga3257c2c989c28308991a0eace3d38e69"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7fb404a6aa92465cf74a3fd4a5c48d37"><td class="memItemLeft" align="right" valign="top">real function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__astronomy__mod.html#ga7fb404a6aa92465cf74a3fd4a5c48d37">orbital_time</a> (time)</td></tr>
<tr class="memdesc:ga7fb404a6aa92465cf74a3fd4a5c48d37"><td class="mdescLeft">&#160;</td><td class="mdescRight">Orbital time returns the time (1 year = 2*pi) since autumnal equinox.  <a href="group__astronomy__mod.html#ga7fb404a6aa92465cf74a3fd4a5c48d37">More...</a><br /></td></tr>
<tr class="separator:ga7fb404a6aa92465cf74a3fd4a5c48d37"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa2cc4e0964e5251d056c4f05c4a8ddf7"><td class="memItemLeft" align="right" valign="top">real function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__astronomy__mod.html#gaa2cc4e0964e5251d056c4f05c4a8ddf7">universal_time</a> (time)</td></tr>
<tr class="memdesc:gaa2cc4e0964e5251d056c4f05c4a8ddf7"><td class="mdescLeft">&#160;</td><td class="mdescRight">universal_time returns the time of day at longitude = 0.0 (1 day = 2*pi)  <a href="group__astronomy__mod.html#gaa2cc4e0964e5251d056c4f05c4a8ddf7">More...</a><br /></td></tr>
<tr class="separator:gaa2cc4e0964e5251d056c4f05c4a8ddf7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ga4201f6ef6d14eec3187bc75206c07e7c"><td class="memItemLeft" align="right" valign="top"><a id="ga4201f6ef6d14eec3187bc75206c07e7c"></a>
real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__astronomy__mod.html#ga4201f6ef6d14eec3187bc75206c07e7c">ecc</a> = 0.01671</td></tr>
<tr class="memdesc:ga4201f6ef6d14eec3187bc75206c07e7c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Eccentricity of Earth's orbit [dimensionless]. <br /></td></tr>
<tr class="separator:ga4201f6ef6d14eec3187bc75206c07e7c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8851cf810eeeb692cc026113f97386b4"><td class="memItemLeft" align="right" valign="top"><a id="ga8851cf810eeeb692cc026113f97386b4"></a>
real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__astronomy__mod.html#ga8851cf810eeeb692cc026113f97386b4">obliq</a> = 23.439</td></tr>
<tr class="memdesc:ga8851cf810eeeb692cc026113f97386b4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Obliquity [degrees]. <br /></td></tr>
<tr class="separator:ga8851cf810eeeb692cc026113f97386b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf264af67ad73c075e6865596a4a3a397"><td class="memItemLeft" align="right" valign="top"><a id="gaf264af67ad73c075e6865596a4a3a397"></a>
real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__astronomy__mod.html#gaf264af67ad73c075e6865596a4a3a397">per</a> = 102.932</td></tr>
<tr class="memdesc:gaf264af67ad73c075e6865596a4a3a397"><td class="mdescLeft">&#160;</td><td class="mdescRight">Longitude of perihelion with respect to autumnal equinox in NH [degrees]. <br /></td></tr>
<tr class="separator:gaf264af67ad73c075e6865596a4a3a397"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4af111fe62fa2772a47f0484a1e4adb0"><td class="memItemLeft" align="right" valign="top"><a id="ga4af111fe62fa2772a47f0484a1e4adb0"></a>
integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__astronomy__mod.html#ga4af111fe62fa2772a47f0484a1e4adb0">period</a> = 0</td></tr>
<tr class="memdesc:ga4af111fe62fa2772a47f0484a1e4adb0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Specified length of year [seconds]; must be specified to override default value given by length_of_year in time_manager_mod. <br /></td></tr>
<tr class="separator:ga4af111fe62fa2772a47f0484a1e4adb0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gabf926e53591ff020492feae586455bdf"><td class="memItemLeft" align="right" valign="top"><a id="gabf926e53591ff020492feae586455bdf"></a>
integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__astronomy__mod.html#gabf926e53591ff020492feae586455bdf">day_ae</a> = 23</td></tr>
<tr class="memdesc:gabf926e53591ff020492feae586455bdf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Day of specified autumnal equinox. <br /></td></tr>
<tr class="separator:gabf926e53591ff020492feae586455bdf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga950d13661623d081cc81a387b6cc0b77"><td class="memItemLeft" align="right" valign="top"><a id="ga950d13661623d081cc81a387b6cc0b77"></a>
integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__astronomy__mod.html#ga950d13661623d081cc81a387b6cc0b77">month_ae</a> = 9</td></tr>
<tr class="memdesc:ga950d13661623d081cc81a387b6cc0b77"><td class="mdescLeft">&#160;</td><td class="mdescRight">Month of specified autumnal equinox. <br /></td></tr>
<tr class="separator:ga950d13661623d081cc81a387b6cc0b77"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga89a3171b8c7d4c50c5c41fbaaca576e3"><td class="memItemLeft" align="right" valign="top"><a id="ga89a3171b8c7d4c50c5c41fbaaca576e3"></a>
integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__astronomy__mod.html#ga89a3171b8c7d4c50c5c41fbaaca576e3">year_ae</a> = 1998</td></tr>
<tr class="memdesc:ga89a3171b8c7d4c50c5c41fbaaca576e3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Year of specified autumnal equinox. <br /></td></tr>
<tr class="separator:ga89a3171b8c7d4c50c5c41fbaaca576e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac9fe51e6e306b8564911a084b8658aca"><td class="memItemLeft" align="right" valign="top"><a id="gac9fe51e6e306b8564911a084b8658aca"></a>
integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__astronomy__mod.html#gac9fe51e6e306b8564911a084b8658aca">hour_ae</a> = 5</td></tr>
<tr class="memdesc:gac9fe51e6e306b8564911a084b8658aca"><td class="mdescLeft">&#160;</td><td class="mdescRight">Hour of specified autumnal equinox. <br /></td></tr>
<tr class="separator:gac9fe51e6e306b8564911a084b8658aca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga45b6936387832601623c84dccbeb7b30"><td class="memItemLeft" align="right" valign="top"><a id="ga45b6936387832601623c84dccbeb7b30"></a>
integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__astronomy__mod.html#ga45b6936387832601623c84dccbeb7b30">minute_ae</a> = 37</td></tr>
<tr class="memdesc:ga45b6936387832601623c84dccbeb7b30"><td class="mdescLeft">&#160;</td><td class="mdescRight">Minute of specified autumnal equinox. <br /></td></tr>
<tr class="separator:ga45b6936387832601623c84dccbeb7b30"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0cad89f046bb5225b3e0ff887f5c75b5"><td class="memItemLeft" align="right" valign="top"><a id="ga0cad89f046bb5225b3e0ff887f5c75b5"></a>
integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__astronomy__mod.html#ga0cad89f046bb5225b3e0ff887f5c75b5">second_ae</a> = 0</td></tr>
<tr class="memdesc:ga0cad89f046bb5225b3e0ff887f5c75b5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Second of specified autumnal equinox. <br /></td></tr>
<tr class="separator:ga0cad89f046bb5225b3e0ff887f5c75b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8031fcc1923a04c1f440a6b64e733a1d"><td class="memItemLeft" align="right" valign="top"><a id="ga8031fcc1923a04c1f440a6b64e733a1d"></a>
integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__astronomy__mod.html#ga8031fcc1923a04c1f440a6b64e733a1d">num_angles</a> = 3600</td></tr>
<tr class="memdesc:ga8031fcc1923a04c1f440a6b64e733a1d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of intervals into which the year is divided to compute orbital positions. <br /></td></tr>
<tr class="separator:ga8031fcc1923a04c1f440a6b64e733a1d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3455a617595c26820155d59d85932a72"><td class="memItemLeft" align="right" valign="top"><a id="ga3455a617595c26820155d59d85932a72"></a>
type(<a class="el" href="structtime__manager__mod_1_1time__type.html">time_type</a>)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__astronomy__mod.html#ga3455a617595c26820155d59d85932a72">autumnal_eq_ref</a></td></tr>
<tr class="memdesc:ga3455a617595c26820155d59d85932a72"><td class="mdescLeft">&#160;</td><td class="mdescRight">time_type variable containing specified time of reference NH autumnal equinox <br /></td></tr>
<tr class="separator:ga3455a617595c26820155d59d85932a72"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae81380ba290de3d3d4ed23bb9e04d6d3"><td class="memItemLeft" align="right" valign="top"><a id="gae81380ba290de3d3d4ed23bb9e04d6d3"></a>
type(<a class="el" href="structtime__manager__mod_1_1time__type.html">time_type</a>)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__astronomy__mod.html#gae81380ba290de3d3d4ed23bb9e04d6d3">period_time_type</a></td></tr>
<tr class="memdesc:gae81380ba290de3d3d4ed23bb9e04d6d3"><td class="mdescLeft">&#160;</td><td class="mdescRight">time_type variable containing period of one orbit <br /></td></tr>
<tr class="separator:gae81380ba290de3d3d4ed23bb9e04d6d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gabcae04094103f1be01eba442f30515af"><td class="memItemLeft" align="right" valign="top"><a id="gabcae04094103f1be01eba442f30515af"></a>
real, dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__astronomy__mod.html#gabcae04094103f1be01eba442f30515af">orb_angle</a></td></tr>
<tr class="memdesc:gabcae04094103f1be01eba442f30515af"><td class="mdescLeft">&#160;</td><td class="mdescRight">table of orbital positions (0 to 2*pi) as a function of time used to find actual orbital position via interpolation <br /></td></tr>
<tr class="separator:gabcae04094103f1be01eba442f30515af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8f512a99427f419c16fe39c389ead097"><td class="memItemLeft" align="right" valign="top"><a id="ga8f512a99427f419c16fe39c389ead097"></a>
real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__astronomy__mod.html#ga8f512a99427f419c16fe39c389ead097">seconds_per_day</a> =86400.</td></tr>
<tr class="memdesc:ga8f512a99427f419c16fe39c389ead097"><td class="mdescLeft">&#160;</td><td class="mdescRight">seconds in a day <br /></td></tr>
<tr class="separator:ga8f512a99427f419c16fe39c389ead097"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab5621931c46d03267c1c40f0f25d480d"><td class="memItemLeft" align="right" valign="top"><a id="gab5621931c46d03267c1c40f0f25d480d"></a>
real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__astronomy__mod.html#gab5621931c46d03267c1c40f0f25d480d">deg_to_rad</a></td></tr>
<tr class="memdesc:gab5621931c46d03267c1c40f0f25d480d"><td class="mdescLeft">&#160;</td><td class="mdescRight">conversion from degrees to radians <br /></td></tr>
<tr class="separator:gab5621931c46d03267c1c40f0f25d480d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaef9287e7ceefb61829fbd0fdb0d7ba47"><td class="memItemLeft" align="right" valign="top"><a id="gaef9287e7ceefb61829fbd0fdb0d7ba47"></a>
real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__astronomy__mod.html#gaef9287e7ceefb61829fbd0fdb0d7ba47">twopi</a></td></tr>
<tr class="memdesc:gaef9287e7ceefb61829fbd0fdb0d7ba47"><td class="mdescLeft">&#160;</td><td class="mdescRight">2 *PI <br /></td></tr>
<tr class="separator:gaef9287e7ceefb61829fbd0fdb0d7ba47"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad369225c254bc7bda087334ca5d13096"><td class="memItemLeft" align="right" valign="top"><a id="gad369225c254bc7bda087334ca5d13096"></a>
logical&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__astronomy__mod.html#gad369225c254bc7bda087334ca5d13096">module_is_initialized</a> =.false.</td></tr>
<tr class="memdesc:gad369225c254bc7bda087334ca5d13096"><td class="mdescLeft">&#160;</td><td class="mdescRight">has the module been initialized ? <br /></td></tr>
<tr class="separator:gad369225c254bc7bda087334ca5d13096"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gadfb82cadb8494848ea78e039c31e7f34"><td class="memItemLeft" align="right" valign="top"><a id="gadfb82cadb8494848ea78e039c31e7f34"></a>
real, dimension(:,:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__astronomy__mod.html#gadfb82cadb8494848ea78e039c31e7f34">cosz_ann</a></td></tr>
<tr class="memdesc:gadfb82cadb8494848ea78e039c31e7f34"><td class="mdescLeft">&#160;</td><td class="mdescRight">annual mean cos of zenith angle <br /></td></tr>
<tr class="separator:gadfb82cadb8494848ea78e039c31e7f34"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga28139b1cc89cafd1e02ca5a60a0c350e"><td class="memItemLeft" align="right" valign="top"><a id="ga28139b1cc89cafd1e02ca5a60a0c350e"></a>
real, dimension(:,:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__astronomy__mod.html#ga28139b1cc89cafd1e02ca5a60a0c350e">solar_ann</a></td></tr>
<tr class="memdesc:ga28139b1cc89cafd1e02ca5a60a0c350e"><td class="mdescLeft">&#160;</td><td class="mdescRight">annual mean solar factor <br /></td></tr>
<tr class="separator:ga28139b1cc89cafd1e02ca5a60a0c350e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2935ee79b0857f938ae0032cdf6445f7"><td class="memItemLeft" align="right" valign="top"><a id="ga2935ee79b0857f938ae0032cdf6445f7"></a>
real, dimension(:,:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__astronomy__mod.html#ga2935ee79b0857f938ae0032cdf6445f7">fracday_ann</a></td></tr>
<tr class="memdesc:ga2935ee79b0857f938ae0032cdf6445f7"><td class="mdescLeft">&#160;</td><td class="mdescRight">annual mean daylight fraction <br /></td></tr>
<tr class="separator:ga2935ee79b0857f938ae0032cdf6445f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5b611bbd1ed54c3e703f05d16a04f765"><td class="memItemLeft" align="right" valign="top"><a id="ga5b611bbd1ed54c3e703f05d16a04f765"></a>
real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__astronomy__mod.html#ga5b611bbd1ed54c3e703f05d16a04f765">rrsun_ann</a></td></tr>
<tr class="memdesc:ga5b611bbd1ed54c3e703f05d16a04f765"><td class="mdescLeft">&#160;</td><td class="mdescRight">annual mean earth-sun distance <br /></td></tr>
<tr class="separator:ga5b611bbd1ed54c3e703f05d16a04f765"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gafc625cdedb5a5a3c2340493f19fd08fb"><td class="memItemLeft" align="right" valign="top"><a id="gafc625cdedb5a5a3c2340493f19fd08fb"></a>
logical&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__astronomy__mod.html#gafc625cdedb5a5a3c2340493f19fd08fb">annual_mean_calculated</a> =.false.</td></tr>
<tr class="memdesc:gafc625cdedb5a5a3c2340493f19fd08fb"><td class="mdescLeft">&#160;</td><td class="mdescRight">have the annual mean values been calculated? <br /></td></tr>
<tr class="separator:gafc625cdedb5a5a3c2340493f19fd08fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga867b18beb2aba0632e097f1701629f9b"><td class="memItemLeft" align="right" valign="top"><a id="ga867b18beb2aba0632e097f1701629f9b"></a>
integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__astronomy__mod.html#ga867b18beb2aba0632e097f1701629f9b">num_pts</a> = 0</td></tr>
<tr class="memdesc:ga867b18beb2aba0632e097f1701629f9b"><td class="mdescLeft">&#160;</td><td class="mdescRight">count of grid_boxes for which annual mean astronomy values have been calculated <br /></td></tr>
<tr class="separator:ga867b18beb2aba0632e097f1701629f9b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga705e11112da69e641ca5f8a1732ca383"><td class="memItemLeft" align="right" valign="top"><a id="ga705e11112da69e641ca5f8a1732ca383"></a>
integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__astronomy__mod.html#ga705e11112da69e641ca5f8a1732ca383">total_pts</a></td></tr>
<tr class="memdesc:ga705e11112da69e641ca5f8a1732ca383"><td class="mdescLeft">&#160;</td><td class="mdescRight">number of grid boxes owned by the processor <br /></td></tr>
<tr class="separator:ga705e11112da69e641ca5f8a1732ca383"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Provides astronomical variables for use by other modules within fms. The only currently used interface is for determination of astronomical values needed by the shortwave radiation packages. </p>
<dl class="section author"><dt>Author</dt><dd>Fei Liu </dd></dl>
<h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="gae7804247bd90b8bed01d7769a609f81d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae7804247bd90b8bed01d7769a609f81d">&#9670;&nbsp;</a></span>angle()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real function, private astronomy_mod::angle </td>
          <td>(</td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>t</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>angle determines the position within the earth's orbit at time t in the year (t = 0 at NH autumnal equinox) by interpolating into the orbital position table. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">t</td><td>time of year (between 0 and 2*pi; t=0 at NH autumnal equinox </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Orbital position relative to NH autumnal equinox [radians] </dd></dl>
<p>Define orbital tables indices bracketing current orbital time (int and int_1). Define table index distance between the lower table value (int) and the actual orbital time (x). Define orbital position as being x of the way between int and int_1. Renormalize angle to be within the range 0 to 2*pi.</p>

<p class="definition">Definition at line <a class="el" href="astronomy_8F90_source.html#l02071">2071</a> of file <a class="el" href="astronomy_8F90_source.html">astronomy.F90</a>.</p>

</div>
</div>
<a id="ga5d8127b604bbddae17c0d2d658d2a715"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga5d8127b604bbddae17c0d2d658d2a715">&#9670;&nbsp;</a></span>annual_mean_solar_1d()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine astronomy_mod::annual_mean_solar_1d </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>jst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>jnd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>lat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), intent(out)&#160;</td>
          <td class="paramname"><em>cosz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), intent(out)&#160;</td>
          <td class="paramname"><em>solar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), intent(out)&#160;</td>
          <td class="paramname"><em>fracday</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>rrsun_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>annual_mean_solar_1d creates 2-d input fields from 1-d input fields and then calls annual_mean_solar_2d to obtain 2-d output fields which are then stored into 1-d fields for return to the calling subroutine. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">&lt;jst&gt;</td><td>Starting index of latitude window </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">&lt;jnd&gt;</td><td>Ending index of latitude window </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">&lt;lat&gt;</td><td>Latitudes of model grid points </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">&lt;cosz&gt;</td><td>Cosine of solar zenith angle </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">&lt;solar&gt;</td><td>Shortwave flux factor: cosine of zenith angle * daylight fraction / (earth-sun distance squared) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">&lt;fracday&gt;</td><td>Daylight fraction of time interval </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">&lt;rrsun_out&gt;</td><td>Earth-Sun distance (r) relative to semi-major axis of orbital ellipse (a):(a/r)**2 </td></tr>
  </table>
  </dd>
</dl>
<p>define 2-d versions of input data array.</p>
<p>call annual_mean_solar_2d to calculate the astronomy fields.</p>
<p>place output fields into 1-D arrays for return to calling routine.</p>
<p>if the calculation has been done, simply return the module variables contain the results at the desired latitudes.</p>

<p class="definition">Definition at line <a class="el" href="astronomy_8F90_source.html#l01850">1850</a> of file <a class="el" href="astronomy_8F90_source.html">astronomy.F90</a>.</p>

</div>
</div>
<a id="gab7f32b9b56f90b2506caa6792a5b4061"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab7f32b9b56f90b2506caa6792a5b4061">&#9670;&nbsp;</a></span>annual_mean_solar_2d()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine astronomy_mod::annual_mean_solar_2d </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>js</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>je</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>lat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), intent(out)&#160;</td>
          <td class="paramname"><em>cosz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), intent(out)&#160;</td>
          <td class="paramname"><em>solar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), intent(out)&#160;</td>
          <td class="paramname"><em>fracday</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>rrsun</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>annual_mean_solar_2d returns 2d fields of annual mean values of the cosine of zenith angle, daylight fraction and earth-sun distance at the specified latitude. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">&lt;jst&gt;</td><td>Starting index of latitude window </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">&lt;jnd&gt;</td><td>Ending index of latitude window </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">&lt;lat&gt;</td><td>Latitudes of model grid points </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">&lt;cosz&gt;</td><td>Cosine of solar zenith angle </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">&lt;solar&gt;</td><td>Shortwave flux factor: cosine of zenith angle * daylight fraction / (earth-sun distance squared) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">&lt;fracday&gt;</td><td>Daylight fraction of time interval </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">&lt;rrsun&gt;</td><td>Earth-Sun distance (r) relative to semi-major axis of orbital ellipse (a):(a/r)**2 </td></tr>
  </table>
  </dd>
</dl>
<p>determine annual mean values of solar flux and product of cosz and solar flux by integrating the annual cycle in num_angles orbital increments.</p>
<p>define the flux-weighted annual mean cosine of the zenith angle.</p>
<p>define avg fracday such as to make the avg flux (solar) equal to the product of the avg cosz * avg fracday * assumed mean avg radius of 1.0. it is unlikely that these avg fracday and avg rr will ever be used.</p>
<p>save the values that have been calculated as module variables, if those variables are present; i.e., not the spectral 2-layer model.</p>
<p>increment the points computed counter. set flag to end execution once values have been calculated for all points owned by the processor.</p>
<p>if the calculation has been done, return the appropriate module variables.</p>

<p class="definition">Definition at line <a class="el" href="astronomy_8F90_source.html#l01743">1743</a> of file <a class="el" href="astronomy_8F90_source.html">astronomy.F90</a>.</p>

</div>
</div>
<a id="gad63eb1838f8bd3a04f7323a0dc826c83"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad63eb1838f8bd3a04f7323a0dc826c83">&#9670;&nbsp;</a></span>annual_mean_solar_2level()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine astronomy_mod::annual_mean_solar_2level </td>
          <td>(</td>
          <td class="paramtype">real, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>lat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), intent(out)&#160;</td>
          <td class="paramname"><em>cosz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), intent(out)&#160;</td>
          <td class="paramname"><em>solar</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>annual_mean_solar_2level creates 2-d input fields from 1-d input fields and then calls annual_mean_solar_2d to obtain 2-d output fields which are then stored into 1-d fields for return to the calling subroutine. This subroutine will be called during model initialization. </p>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">FATAL,astronomy_mod annual_mean_solar_2level should be called only once</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">lat</td><td>Latitudes of model grid points </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">cosz</td><td>Cosine of solar zenith angle </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">solar</td><td>shortwave flux factor: cosine of zenith angle * daylight fraction / (earth-sun distance squared) </td></tr>
  </table>
  </dd>
</dl>
<p>define 2-d versions of input data array.</p>
<p>call annual_mean_solar_2d to calculate the astronomy fields.</p>
<p>place output fields into 1-D arrays for return to calling routine.</p>
<p>if the calculation has been done, print an error message since this subroutine should be called only once.</p>

<p class="definition">Definition at line <a class="el" href="astronomy_8F90_source.html#l01910">1910</a> of file <a class="el" href="astronomy_8F90_source.html">astronomy.F90</a>.</p>

</div>
</div>
<a id="ga1cbb745900e141cfee7e422a2f02caa1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga1cbb745900e141cfee7e422a2f02caa1">&#9670;&nbsp;</a></span>astronomy_end()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public astronomy_mod::astronomy_end</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>astronomy_end is the destructor for astronomy_mod. </p>
<p>check if the module has been initialized.</p>
<p>deallocate module variables.</p>
<p>mark the module as uninitialized.</p>

<p class="definition">Definition at line <a class="el" href="astronomy_8F90_source.html#l01966">1966</a> of file <a class="el" href="astronomy_8F90_source.html">astronomy.F90</a>.</p>

</div>
</div>
<a id="ga28a67f4da82725afd9c0051464b8767c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga28a67f4da82725afd9c0051464b8767c">&#9670;&nbsp;</a></span>astronomy_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public astronomy_mod::astronomy_init </td>
          <td>(</td>
          <td class="paramtype">real, dimension(:,:), intent(in), optional&#160;</td>
          <td class="paramname"><em>latb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), intent(in), optional&#160;</td>
          <td class="paramname"><em>lonb</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>astronomy_init is the constructor for astronomy_mod. </p>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">FATAL,astronomy_mod ecc must be between 0 and 0.99</td><td></td></tr>
    <tr><td class="paramname">FATAL,astronomy_mod obliquity must be between -90 and 90 degrees</td><td></td></tr>
    <tr><td class="paramname">FATAL,astronomy_mod perihelion must be between 0 and 360 degrees</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">latb</td><td>2d array of model latitudes at cell corners [radians] </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lonb</td><td>2d array of model longitudes at cell corners [radians] </td></tr>
  </table>
  </dd>
</dl>
<p>This routine will: Verify that modules used by this module have been initialized.</p>
<p>Read namelist.</p>
<p>Write version number and namelist to logfile.</p>
<p>Be sure input values are within valid ranges.</p>
<p>Set up time-type variable defining specified time of autumnal equinox.</p>
<p>Set up time-type variable defining length of year.</p>
<p>Define useful module variables.</p>
<p>Call orbit to define table of orbital angles as function of orbital time.</p>
<p>If annual mean radiation is desired, then latb will be present. allocate arrays to hold the needed astronomical factors. define the total number of points that the processor is responsible for.</p>
<p>Mark the module as initialized.</p>

<p class="definition">Definition at line <a class="el" href="astronomy_8F90_source.html#l00408">408</a> of file <a class="el" href="astronomy_8F90_source.html">astronomy.F90</a>.</p>

</div>
</div>
<a id="ga5a5756a118e2a409d64a7958bc923af2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga5a5756a118e2a409d64a7958bc923af2">&#9670;&nbsp;</a></span>daily_mean_solar_0d()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine astronomy_mod::daily_mean_solar_0d </td>
          <td>(</td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>lat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>time_since_ae</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>cosz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>h_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>rr_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>daily_mean_solar_1d takes 1-d input fields, adds a second dimension and calls daily_mean_solar_2d. on return, the 2d fields are returned to the original 1d fields. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">&lt;lat&gt;</td><td>Latitudes of model grid points </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">&lt;time_since_ae&gt;</td><td>Time of year; autumnal equinox = 0.0, one year = 2 * pi </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">&lt;cosz&gt;</td><td>Cosine of solar zenith angle </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">&lt;h_out&gt;</td><td>2-d array of half-day lengths at the latitudes </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">&lt;rr_out&gt;</td><td>the inverse of the square of the earth-sun distance relative to the mean distance at angle ang in the earth's orbit. </td></tr>
  </table>
  </dd>
</dl>
<p>define 2-d versions of input data array.</p>
<p>call daily_mean_solar_2d to calculate astronomy fields.</p>
<p>return output fields to scalars for return to calling routine.</p>

<p class="definition">Definition at line <a class="el" href="astronomy_8F90_source.html#l01530">1530</a> of file <a class="el" href="astronomy_8F90_source.html">astronomy.F90</a>.</p>

</div>
</div>
<a id="gad097b3db07240f4b90b2a34942960f62"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad097b3db07240f4b90b2a34942960f62">&#9670;&nbsp;</a></span>daily_mean_solar_1d()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine astronomy_mod::daily_mean_solar_1d </td>
          <td>(</td>
          <td class="paramtype">real, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>lat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>time_since_ae</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(size(lat(:))), intent(out)&#160;</td>
          <td class="paramname"><em>cosz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(size(lat(:))), intent(out)&#160;</td>
          <td class="paramname"><em>h_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>rr_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>daily_mean_solar_1d takes 1-d input fields, adds a second dimension and calls daily_mean_solar_2d. on return, the 2d fields are returned to the original 1d fields. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">&lt;lat&gt;</td><td>Latitudes of model grid points </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">&lt;time_since_ae&gt;</td><td>Time of year; autumnal equinox = 0.0, one year = 2 * pi </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">&lt;cosz&gt;</td><td>Cosine of solar zenith angle </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">&lt;h_out&gt;</td><td>2-d array of half-day lengths at the latitudes </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">&lt;rr_out&gt;</td><td>the inverse of the square of the earth-sun distance relative to the mean distance at angle ang in the earth's orbit. </td></tr>
  </table>
  </dd>
</dl>
<p>define 2-d versions of input data array.</p>
<p>call daily_mean_solar_2d to calculate astronomy fields.</p>
<p>place output fields into 1-d arguments for return to calling routine.</p>

<p class="definition">Definition at line <a class="el" href="astronomy_8F90_source.html#l01441">1441</a> of file <a class="el" href="astronomy_8F90_source.html">astronomy.F90</a>.</p>

</div>
</div>
<a id="ga699784bad69d4edfa2551c303acd875c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga699784bad69d4edfa2551c303acd875c">&#9670;&nbsp;</a></span>daily_mean_solar_2d()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine astronomy_mod::daily_mean_solar_2d </td>
          <td>(</td>
          <td class="paramtype">real, dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>lat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>time_since_ae</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), intent(out)&#160;</td>
          <td class="paramname"><em>cosz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), intent(out)&#160;</td>
          <td class="paramname"><em>h_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>rr_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>daily_mean_solar_2d computes the daily mean astronomical parameters for the input points at latitude lat and time of year time_since_ae. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">&lt;lat&gt;</td><td>Latitudes of model grid points </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">&lt;time_since_ae&gt;</td><td>Time of year; autumnal equinox = 0.0, one year = 2 * pi </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">&lt;cosz&gt;</td><td>Cosine of solar zenith angle </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">&lt;h_out&gt;</td><td>2-d array of half-day lengths at the latitudes </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">&lt;rr_out&gt;</td><td>the inverse of the square of the earth-sun distance relative to the mean distance at angle ang in the earth's orbit.</td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">FATAL,astronomy_mod time_since_ae not between 0 and 2pi</td><td></td></tr>
  </table>
  </dd>
</dl>
<p>Define the orbital angle (location in year), solar declination, half-day length and earth sun distance factor. Use functions contained in this module.</p>
<p>Where the entire day is dark, define cosz to be zero. otherwise use the standard formula. Define the daylight fraction and earth- sun distance.</p>

<p class="definition">Definition at line <a class="el" href="astronomy_8F90_source.html#l01383">1383</a> of file <a class="el" href="astronomy_8F90_source.html">astronomy.F90</a>.</p>

</div>
</div>
<a id="ga796094232cd50abc686b52548b3c3b2a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga796094232cd50abc686b52548b3c3b2a">&#9670;&nbsp;</a></span>daily_mean_solar_2level()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine astronomy_mod::daily_mean_solar_2level </td>
          <td>(</td>
          <td class="paramtype">real, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>lat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>time_since_ae</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(size(lat(:))), intent(out)&#160;</td>
          <td class="paramname"><em>cosz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(size(lat(:))), intent(out)&#160;</td>
          <td class="paramname"><em>solar</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>daily_mean_solar_2level takes 1-d input fields, adds a second dimension and calls daily_mean_solar_2d. on return, the 2d fields are returned to the original 1d fields. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">&lt;lat&gt;</td><td>Latitudes of model grid points </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">&lt;time_since_ae&gt;</td><td>Time of year; autumnal equinox = 0.0, one year = 2 * pi </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">&lt;cosz&gt;</td><td>Cosine of solar zenith angle </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">&lt;solar&gt;</td><td>Shortwave flux factor: cosine of zenith angle * daylight fraction / (earth-sun distance squared) </td></tr>
  </table>
  </dd>
</dl>
<p>define 2-d versions of input data array.</p>
<p>call daily_mean_solar_2d to calculate astronomy fields.</p>
<p>place output fields into 1-d arguments for return to calling routine.</p>

<p class="definition">Definition at line <a class="el" href="astronomy_8F90_source.html#l01485">1485</a> of file <a class="el" href="astronomy_8F90_source.html">astronomy.F90</a>.</p>

</div>
</div>
<a id="ga42ef874f203c88171bef1573c9f96c73"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga42ef874f203c88171bef1573c9f96c73">&#9670;&nbsp;</a></span>daily_mean_solar_cal_0d()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine astronomy_mod::daily_mean_solar_cal_0d </td>
          <td>(</td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>lat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structtime__manager__mod_1_1time__type.html">time_type</a>), intent(in)&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>cosz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>fracday</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>rrsun</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>daily_mean_solar_cal_0d converts scalar input fields to real, 2d variables and then calls daily_mean_solar_2d to compute desired astronomical variables. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">&lt;lat&gt;</td><td>Latitudes of model grid points </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">&lt;time&gt;</td><td>Time of year (time_type) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">&lt;cosz&gt;</td><td>Cosine of solar zenith angle </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">&lt;fracday&gt;</td><td>Daylight fraction of time interval </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">&lt;rrsun&gt;</td><td>Earth-Sun distance (r) relative to semi-major axis of orbital ellipse (a):(a/r)**2 </td></tr>
  </table>
  </dd>
</dl>
<p>define 2-d versions of input data array.</p>
<p>call daily_mean_solar_cal_2d to convert the time_types to reals and then calculate the astronomy fields.</p>
<p>place output fields into scalar arguments for return to calling routine.</p>

<p class="definition">Definition at line <a class="el" href="astronomy_8F90_source.html#l01697">1697</a> of file <a class="el" href="astronomy_8F90_source.html">astronomy.F90</a>.</p>

</div>
</div>
<a id="ga6a985f1ba0f71868c80cd95b9f4de668"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga6a985f1ba0f71868c80cd95b9f4de668">&#9670;&nbsp;</a></span>daily_mean_solar_cal_1d()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine astronomy_mod::daily_mean_solar_cal_1d </td>
          <td>(</td>
          <td class="paramtype">real, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>lat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structtime__manager__mod_1_1time__type.html">time_type</a>), intent(in)&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), intent(out)&#160;</td>
          <td class="paramname"><em>cosz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), intent(out)&#160;</td>
          <td class="paramname"><em>fracday</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>rrsun</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>daily_mean_solar_cal_1d receives time_type inputs, converts them to real, 2d variables and then calls daily_mean_solar_2d to compute desired astronomical variables. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">&lt;lat&gt;</td><td>Latitudes of model grid points </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">&lt;time&gt;</td><td>Time of year (time_type) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">&lt;cosz&gt;</td><td>Cosine of solar zenith angle </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">&lt;fracday&gt;</td><td>Daylight fraction of time interval </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">&lt;rrsun&gt;</td><td>Earth-Sun distance (r) relative to semi-major axis of orbital ellipse (a):(a/r)**2 </td></tr>
  </table>
  </dd>
</dl>
<p>define 2-d versions of input data array.</p>
<p>call daily_mean_solar_cal_2d to convert the time_types to reals and then calculate the astronomy fields.</p>
<p>place output fields into 1-d arguments for return to calling routine.</p>

<p class="definition">Definition at line <a class="el" href="astronomy_8F90_source.html#l01611">1611</a> of file <a class="el" href="astronomy_8F90_source.html">astronomy.F90</a>.</p>

</div>
</div>
<a id="gaf6094e628e630913842bcb468f8d39a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf6094e628e630913842bcb468f8d39a2">&#9670;&nbsp;</a></span>daily_mean_solar_cal_2d()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine astronomy_mod::daily_mean_solar_cal_2d </td>
          <td>(</td>
          <td class="paramtype">real, dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>lat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structtime__manager__mod_1_1time__type.html">time_type</a>), intent(in)&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), intent(out)&#160;</td>
          <td class="paramname"><em>cosz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), intent(out)&#160;</td>
          <td class="paramname"><em>fracday</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>rrsun</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>daily_mean_solar_cal_2d receives time_type inputs, converts them to real variables and then calls daily_mean_solar_2d to compute desired astronomical variables. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">&lt;lat&gt;</td><td>Latitudes of model grid points </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">&lt;time&gt;</td><td>Time of year (time_type) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">&lt;cosz&gt;</td><td>Cosine of solar zenith angle </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">&lt;fracday&gt;</td><td>Daylight fraction of time interval </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">&lt;rrsun&gt;</td><td>Earth-Sun distance (r) relative to semi-major axis of orbital ellipse (a):(a/r)**2</td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">FATAL,astronomy_mod time_since_ae not between 0 and 2pi</td><td></td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="astronomy_8F90_source.html#l01571">1571</a> of file <a class="el" href="astronomy_8F90_source.html">astronomy.F90</a>.</p>

</div>
</div>
<a id="gab81094cd66751b014bb2179d6d3667b6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab81094cd66751b014bb2179d6d3667b6">&#9670;&nbsp;</a></span>daily_mean_solar_cal_2level()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine astronomy_mod::daily_mean_solar_cal_2level </td>
          <td>(</td>
          <td class="paramtype">real, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>lat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structtime__manager__mod_1_1time__type.html">time_type</a>), intent(in)&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), intent(out)&#160;</td>
          <td class="paramname"><em>cosz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), intent(out)&#160;</td>
          <td class="paramname"><em>solar</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>daily_mean_solar_cal_2level receives 1d arrays and time_type input, converts them to real, 2d variables and then calls daily_mean_solar_2d to compute desired astronomical variables. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">&lt;lat&gt;</td><td>Latitudes of model grid points </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">&lt;time&gt;</td><td>Time of year (time_type) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">&lt;cosz&gt;</td><td>Cosine of solar zenith angle </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">&lt;solar&gt;</td><td>Shortwave flux factor: cosine of zenith angle * daylight fraction / (earth-sun distance squared) </td></tr>
  </table>
  </dd>
</dl>
<p>define 2-d versions of input data array.</p>
<p>call daily_mean_solar_cal_2d to convert the time_types to reals and then calculate the astronomy fields.</p>
<p>place output fields into 1-d arguments for return to calling routine.</p>

<p class="definition">Definition at line <a class="el" href="astronomy_8F90_source.html#l01654">1654</a> of file <a class="el" href="astronomy_8F90_source.html">astronomy.F90</a>.</p>

</div>
</div>
<a id="ga4161170ad847a225cb01bee3f3a29041"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4161170ad847a225cb01bee3f3a29041">&#9670;&nbsp;</a></span>declination()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real function, private astronomy_mod::declination </td>
          <td>(</td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>ang</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Declination returns the solar declination angle at orbital position ang in earth's orbit. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ang</td><td>solar orbital position ang in earth's orbit </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Solar declination angle [radians] </dd></dl>

<p class="definition">Definition at line <a class="el" href="astronomy_8F90_source.html#l02106">2106</a> of file <a class="el" href="astronomy_8F90_source.html">astronomy.F90</a>.</p>

</div>
</div>
<a id="ga54ac46fdf8eb5cf66f27c8995ce017da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga54ac46fdf8eb5cf66f27c8995ce017da">&#9670;&nbsp;</a></span>diurnal_solar_0d()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine astronomy_mod::diurnal_solar_0d </td>
          <td>(</td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>lat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>lon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>gmt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>time_since_ae</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>cosz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>fracday</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>rrsun</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in), optional&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>allow_negative_cosz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out), optional&#160;</td>
          <td class="paramname"><em>half_day_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>diurnal_solar_0d takes scalar input fields, makes them into 2d arrays dimensioned (1,1), and calls diurnal_solar_2d. on return, the 2d fields are converted back to the desired scalar output. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">&lt;lat&gt;</td><td>Latitudes of model grid points </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">&lt;lon&gt;</td><td>Longitudes of model grid points </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">&lt;gmt&gt;</td><td>Time of day at longitude 0.0; midnight = 0.0, one day = 2 * pi </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">&lt;time_since_ae&gt;</td><td>Time of year; autumnal equinox = 0.0, one year = 2 * pi </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">&lt;cosz&gt;</td><td>Cosine of solar zenith angle </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">&lt;fracday&gt;</td><td>Daylight fraction of time interval </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">&lt;rrsun&gt;</td><td>earth-sun distance (r) relative to semi-major axis of orbital ellipse (a):(a/r)**2 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">&lt;dt&gt;</td><td>OPTIONAL: time interval after gmt over which the astronomical variables are to be averaged. this produces averaged output rather than instantaneous. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">&lt;allow_negative_cosz&gt;</td><td>Allow negative values for cosz? </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">&lt;half_day_out&gt;</td><td>half_day_out </td></tr>
  </table>
  </dd>
</dl>
<p>create 2d arrays from the scalar input fields.</p>
<p>call diurnal_solar_2d to calculate astronomy fields.</p>
<p>place output fields into scalars for return to calling routine.</p>

<p class="definition">Definition at line <a class="el" href="astronomy_8F90_source.html#l01107">1107</a> of file <a class="el" href="astronomy_8F90_source.html">astronomy.F90</a>.</p>

</div>
</div>
<a id="ga092642be4e355e43086c904d9fcb8d39"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga092642be4e355e43086c904d9fcb8d39">&#9670;&nbsp;</a></span>diurnal_solar_1d()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine astronomy_mod::diurnal_solar_1d </td>
          <td>(</td>
          <td class="paramtype">real, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>lat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>lon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>gmt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>time_since_ae</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), intent(out)&#160;</td>
          <td class="paramname"><em>cosz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), intent(out)&#160;</td>
          <td class="paramname"><em>fracday</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>rrsun</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in), optional&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>allow_negative_cosz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), intent(out), optional&#160;</td>
          <td class="paramname"><em>half_day_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>diurnal_solar_1d takes 1-d input fields, adds a second dimension and calls diurnal_solar_2d. on return, the 2d fields are returned to the original 1d fields. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">&lt;lat&gt;</td><td>Latitudes of model grid points </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">&lt;lon&gt;</td><td>Longitudes of model grid points </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">&lt;gmt&gt;</td><td>Time of day at longitude 0.0; midnight = 0.0, one day = 2 * pi </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">&lt;time_since_ae&gt;</td><td>Time of year; autumnal equinox = 0.0, one year = 2 * pi </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">&lt;cosz&gt;</td><td>Cosine of solar zenith angle </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">&lt;fracday&gt;</td><td>Daylight fraction of time interval </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">&lt;rrsun&gt;</td><td>earth-sun distance (r) relative to semi-major axis of orbital ellipse (a):(a/r)**2 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">&lt;dt&gt;</td><td>OPTIONAL: time interval after gmt over which the astronomical variables are to be averaged. this produces averaged output rather than instantaneous. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">&lt;allow_negative_cosz&gt;</td><td>Allow negative values for cosz? </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">&lt;half_day_out&gt;</td><td>half_day_out </td></tr>
  </table>
  </dd>
</dl>
<p>define 2-d versions of input data arrays.</p>
<p>call diurnal_solar_2d to calculate astronomy fields.</p>
<p>place output fields into 1-d arguments for return to calling routine.</p>

<p class="definition">Definition at line <a class="el" href="astronomy_8F90_source.html#l01041">1041</a> of file <a class="el" href="astronomy_8F90_source.html">astronomy.F90</a>.</p>

</div>
</div>
<a id="ga8a9bd207af7b8495bb6768ab44b5a3f6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga8a9bd207af7b8495bb6768ab44b5a3f6">&#9670;&nbsp;</a></span>diurnal_solar_2d()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine astronomy_mod::diurnal_solar_2d </td>
          <td>(</td>
          <td class="paramtype">real, dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>lat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>lon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>gmt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>time_since_ae</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), intent(out)&#160;</td>
          <td class="paramname"><em>cosz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), intent(out)&#160;</td>
          <td class="paramname"><em>fracday</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>rrsun</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in), optional&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>allow_negative_cosz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), intent(out), optional&#160;</td>
          <td class="paramname"><em>half_day_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>diurnal_solar_2d returns 2d fields of cosine of zenith angle, daylight fraction and earth-sun distance at the specified latitudes, longitudes and time. These values may be instantaneous or averaged over a specified time interval. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">&lt;lat&gt;</td><td>Latitudes of model grid points </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">&lt;lon&gt;</td><td>Longitudes of model grid points </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">&lt;gmt&gt;</td><td>Time of day at longitude 0.0; midnight = 0.0, one day = 2 * pi </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">&lt;time_since_ae&gt;</td><td>Time of year; autumnal equinox = 0.0, one year = 2 * pi </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">&lt;cosz&gt;</td><td>Cosine of solar zenith angle </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">&lt;fracday&gt;</td><td>Daylight fraction of time interval </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">&lt;rrsun&gt;</td><td>earth-sun distance (r) relative to semi-major axis of orbital ellipse (a):(a/r)**2 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">&lt;dt&gt;</td><td>OPTIONAL: time interval after gmt over which the astronomical variables are to be averaged. this produces averaged output rather than instantaneous. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">&lt;allow_negative_cosz&gt;</td><td>Allow negative values for cosz? </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">&lt;half_day_out&gt;</td><td>half_day_out</td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">FATAL,astronomy_mod time_since_ae not between 0 and 2pi</td><td></td></tr>
    <tr><td class="paramname">FATAL,astronomy_mod gmt not between 0 and 2pi</td><td></td></tr>
  </table>
  </dd>
</dl>
<p>define the orbital angle (location in year), solar declination and earth sun distance factor. use functions contained in this module.</p>
<p>define terms needed in the cosine zenith angle equation.</p>
<p>define local time. force it to be between -pi and pi.</p>
<p>perform a time integration to obtain cosz and fracday if desired. output is valid over the period from t to t + dt.</p>
<p>if instantaneous values are desired, define cosz at time t.</p>
<p>Check that cosz is not negative, if desired.</p>

<p class="definition">Definition at line <a class="el" href="astronomy_8F90_source.html#l00818">818</a> of file <a class="el" href="astronomy_8F90_source.html">astronomy.F90</a>.</p>

</div>
</div>
<a id="gae1cf91fe03ba0c23f228d6f3495e4068"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae1cf91fe03ba0c23f228d6f3495e4068">&#9670;&nbsp;</a></span>diurnal_solar_cal_0d()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine astronomy_mod::diurnal_solar_cal_0d </td>
          <td>(</td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>lat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>lon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structtime__manager__mod_1_1time__type.html">time_type</a>), intent(in)&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>cosz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>fracday</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>rrsun</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structtime__manager__mod_1_1time__type.html">time_type</a>), intent(in), optional&#160;</td>
          <td class="paramname"><em>dt_time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>allow_negative_cosz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out), optional&#160;</td>
          <td class="paramname"><em>half_day_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>diurnal_solar_cal_0d receives time_type inputs, converts them to real variables and then calls diurnal_solar_2d to compute desired astronomical variables. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">&lt;lat&gt;</td><td>Latitudes of model grid points </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">&lt;lon&gt;</td><td>Longitudes of model grid points </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">&lt;time&gt;</td><td>Time of year (time_type) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">&lt;cosz&gt;</td><td>Cosine of solar zenith angle </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">&lt;fracday&gt;</td><td>Daylight fraction of time interval </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">&lt;rrsun&gt;</td><td>Earth-Sun distance (r) relative to semi-major axis of orbital ellipse (a) : (a/r)**2 </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">&lt;dt_time&gt;</td><td>OPTIONAL: time interval after gmt over which the astronomical variables are to be averaged. this produces averaged output rather than instantaneous. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">&lt;allow_negative_cosz&gt;</td><td>allow_negative_cosz </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">&lt;half_day_out&gt;</td><td>half_day_out </td></tr>
  </table>
  </dd>
</dl>
<p>Define 2-d versions of input data arrays.</p>
<p>Call diurnal_solar_cal_2d to convert the time_types to reals and then calculate the astronomy fields.</p>
<p>Place output fields into 1-d arguments for return to calling routine.</p>

<p class="definition">Definition at line <a class="el" href="astronomy_8F90_source.html#l01321">1321</a> of file <a class="el" href="astronomy_8F90_source.html">astronomy.F90</a>.</p>

</div>
</div>
<a id="ga42d49be6db81f5ab9e4974b523f52dae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga42d49be6db81f5ab9e4974b523f52dae">&#9670;&nbsp;</a></span>diurnal_solar_cal_1d()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine astronomy_mod::diurnal_solar_cal_1d </td>
          <td>(</td>
          <td class="paramtype">real, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>lat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>lon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structtime__manager__mod_1_1time__type.html">time_type</a>), intent(in)&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), intent(out)&#160;</td>
          <td class="paramname"><em>cosz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), intent(out)&#160;</td>
          <td class="paramname"><em>fracday</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>rrsun</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structtime__manager__mod_1_1time__type.html">time_type</a>), intent(in), optional&#160;</td>
          <td class="paramname"><em>dt_time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>allow_negative_cosz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), intent(out), optional&#160;</td>
          <td class="paramname"><em>half_day_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>diurnal_solar_cal_1d receives time_type inputs, converts them to real variables and then calls diurnal_solar_2d to compute desired astronomical variables. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">&lt;lat&gt;</td><td>Latitudes of model grid points </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">&lt;lon&gt;</td><td>Longitudes of model grid points </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">&lt;gmt&gt;</td><td>Time of day at longitude 0.0; midnight = 0.0, one day = 2 * pi </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">&lt;time&gt;</td><td>Time of year (time_type) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">&lt;cosz&gt;</td><td>Cosine of solar zenith angle </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">&lt;fracday&gt;</td><td>Daylight fraction of time interval </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">&lt;rrsun&gt;</td><td>earth-sun distance (r) relative to semi-major axis of orbital ellipse (a):(a/r)**2 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">&lt;dt&gt;</td><td>OPTIONAL: time interval after gmt over which the astronomical variables are to be averaged. this produces averaged output rather than instantaneous. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">&lt;allow_negative_cosz&gt;</td><td>Allow negative values for cosz? </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">&lt;half_day_out&gt;</td><td>half_day_out </td></tr>
  </table>
  </dd>
</dl>
<p>Define 2-d versions of input data arrays.</p>
<p>Call diurnal_solar_cal_2d to convert the time_types to reals and then calculate the astronomy fields.</p>
<p>Place output fields into 1-d arguments for return to calling routine.</p>

<p class="definition">Definition at line <a class="el" href="astronomy_8F90_source.html#l01253">1253</a> of file <a class="el" href="astronomy_8F90_source.html">astronomy.F90</a>.</p>

</div>
</div>
<a id="ga6bc8afe25709ff957b1e3a6fa5c33a8d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga6bc8afe25709ff957b1e3a6fa5c33a8d">&#9670;&nbsp;</a></span>diurnal_solar_cal_2d()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine astronomy_mod::diurnal_solar_cal_2d </td>
          <td>(</td>
          <td class="paramtype">real, dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>lat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>lon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structtime__manager__mod_1_1time__type.html">time_type</a>), intent(in)&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), intent(out)&#160;</td>
          <td class="paramname"><em>cosz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), intent(out)&#160;</td>
          <td class="paramname"><em>fracday</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>rrsun</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structtime__manager__mod_1_1time__type.html">time_type</a>), intent(in), optional&#160;</td>
          <td class="paramname"><em>dt_time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>allow_negative_cosz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), intent(out), optional&#160;</td>
          <td class="paramname"><em>half_day_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>diurnal_solar_cal_2d receives time_type inputs, converts them to real variables and then calls diurnal_solar_2d to compute desired astronomical variables. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">&lt;lat&gt;</td><td>Latitudes of model grid points </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">&lt;lon&gt;</td><td>Longitudes of model grid points </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">&lt;gmt&gt;</td><td>Time of day at longitude 0.0; midnight = 0.0, one day = 2 * pi </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">&lt;time&gt;</td><td>Time of year (time_type) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">&lt;cosz&gt;</td><td>Cosine of solar zenith angle </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">&lt;fracday&gt;</td><td>Daylight fraction of time interval </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">&lt;rrsun&gt;</td><td>earth-sun distance (r) relative to semi-major axis of orbital ellipse (a):(a/r)**2 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">&lt;dt&gt;</td><td>OPTIONAL: time interval after gmt over which the astronomical variables are to be averaged. this produces averaged output rather than instantaneous. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">&lt;allow_negative_cosz&gt;</td><td>Allow negative values for cosz? </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">&lt;half_day_out&gt;</td><td>half_day_out</td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">FATAL,astronomy_mod radiation time step must be no longer than 12 hrs</td><td></td></tr>
    <tr><td class="paramname">FATAL,astronomy_mod radiation time step must not be an integral number of days</td><td></td></tr>
  </table>
  </dd>
</dl>
<p>Extract time of day (gmt) from time_type variable time with function universal_time.</p>
<p>Extract the time of year (time_since_ae) from time_type variable time using the function orbital_time.</p>
<p>Convert optional time_type variable dt_time (length of averaging period) to a real variable dt with the function universal_time.</p>
<p>Call diurnal_solar_2d to calculate astronomy fields, with or without the optional argument dt.</p>

<p class="definition">Definition at line <a class="el" href="astronomy_8F90_source.html#l01171">1171</a> of file <a class="el" href="astronomy_8F90_source.html">astronomy.F90</a>.</p>

</div>
</div>
<a id="ga3878ea3f081f4d89f7f19bd530767897"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga3878ea3f081f4d89f7f19bd530767897">&#9670;&nbsp;</a></span>get_orbital_parameters()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public astronomy_mod::get_orbital_parameters </td>
          <td>(</td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>ecc_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>obliq_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>per_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>get_orbital_parameters retrieves the orbital parameters for use by another module. </p>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">FATAL,astronomy_mod module has not been initialized</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">ecc_out</td><td>Eccentricity of orbital ellipse [dimensionless] </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">obliq_out</td><td>Obliquity [degrees] </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">per_out</td><td>Longitude of perihelion with respect to autumnal equinox in northern hemisphere [degrees] </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="astronomy_8F90_source.html#l00669">669</a> of file <a class="el" href="astronomy_8F90_source.html">astronomy.F90</a>.</p>

</div>
</div>
<a id="gae2cdd8e2fb16d2d09083ef51fd9fa5f6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae2cdd8e2fb16d2d09083ef51fd9fa5f6">&#9670;&nbsp;</a></span>get_period_integer()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine astronomy_mod::get_period_integer </td>
          <td>(</td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>period_out</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>get_period_integer returns the length of the year as an integer number of seconds. </p>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">FATAL,astronomy_mod module has not been initialized</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">period_out</td><td>Length of year [seconds] </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="astronomy_8F90_source.html#l00517">517</a> of file <a class="el" href="astronomy_8F90_source.html">astronomy.F90</a>.</p>

</div>
</div>
<a id="gadc97a16dbd669dfb2ba2b36daaf34b79"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gadc97a16dbd669dfb2ba2b36daaf34b79">&#9670;&nbsp;</a></span>get_period_time_type()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine astronomy_mod::get_period_time_type </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structtime__manager__mod_1_1time__type.html">time_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>period_out</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>get_period_time_type returns the length of the year as a time_type variable. </p>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">FATAL,astronomy_mod module has not been initialized</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">period_out</td><td>Length of year as time_type variable </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="astronomy_8F90_source.html#l00546">546</a> of file <a class="el" href="astronomy_8F90_source.html">astronomy.F90</a>.</p>

</div>
</div>
<a id="gada396fa1ede7431df75438a6c9d6c771"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gada396fa1ede7431df75438a6c9d6c771">&#9670;&nbsp;</a></span>get_ref_date_of_ae()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public astronomy_mod::get_ref_date_of_ae </td>
          <td>(</td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>day_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>month_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>year_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>second_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>minute_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>hour_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>get_ref_date_of_ae retrieves the reference date of the autumnal equinox as integer variables. </p>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">FATAL,astronomy_mod module has not been initialized</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">&lt;day_out&gt;</td><td>Day of reference autumnal equinox </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">&lt;month_out&gt;</td><td>Month of reference autumnal equinox </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">&lt;year_out&gt;</td><td>Year of reference autumnal equinox </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">&lt;second_out&gt;</td><td>Second of reference autumnal equinox </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">&lt;minute_out&gt;</td><td>Minute of reference autumnal equinox </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">&lt;hour_out&gt;</td><td>Hour of reference autumnal equinox </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="astronomy_8F90_source.html#l00771">771</a> of file <a class="el" href="astronomy_8F90_source.html">astronomy.F90</a>.</p>

</div>
</div>
<a id="ga3257c2c989c28308991a0eace3d38e69"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga3257c2c989c28308991a0eace3d38e69">&#9670;&nbsp;</a></span>half_day_0d()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real function astronomy_mod::half_day_0d </td>
          <td>(</td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>latitude</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>dec</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>half_day_0d takes scalar input fields, makes them into 2-d fields dimensioned (1,1), and calls half_day_2d. On return, the 2-d fields are converted to the desired scalar output. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">&lt;latitude&gt;</td><td>Latitutde of view point </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">&lt;dec&gt;</td><td>Solar declination angle at view point </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="astronomy_8F90_source.html#l02180">2180</a> of file <a class="el" href="astronomy_8F90_source.html">astronomy.F90</a>.</p>

</div>
</div>
<a id="ga47f0a2733fe061cf8f54e0a13256e42c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga47f0a2733fe061cf8f54e0a13256e42c">&#9670;&nbsp;</a></span>half_day_2d()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real function, dimension(size(latitude,1),size(latitude,2)) astronomy_mod::half_day_2d </td>
          <td>(</td>
          <td class="paramtype">real, dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>latitude</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>dec</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>half_day_2d returns a 2-d array of half-day lengths at the latitudes and declination provided. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">latitude</td><td>Latitutde of view point </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dec</td><td>Solar declination angle at view point </td></tr>
  </table>
  </dd>
</dl>
<p>define tangent of the declination.</p>
<p>adjust latitude so that its tangent will be defined.</p>
<p>define the cosine of the half-day length. adjust for cases of all daylight or all night.</p>

<p class="definition">Definition at line <a class="el" href="astronomy_8F90_source.html#l02132">2132</a> of file <a class="el" href="astronomy_8F90_source.html">astronomy.F90</a>.</p>

</div>
</div>
<a id="ga8dccd51b88c5f26258bcaab0b250675d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga8dccd51b88c5f26258bcaab0b250675d">&#9670;&nbsp;</a></span>orbit()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, private astronomy_mod::orbit</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Orbit computes and stores a table of value of orbital angles as a function of orbital time (both the angle and time are zero at autumnal equinox in the NH, and range from 0 to 2*pi). </p>
<p>allocate the orbital angle array, sized by the namelist parameter num_angles, defining the annual cycle resolution of the earth's orbit. define some constants to be used.</p>
<p>define the orbital angle at each of the num_angles locations in the orbit.</p>

<p class="definition">Definition at line <a class="el" href="astronomy_8F90_source.html#l02002">2002</a> of file <a class="el" href="astronomy_8F90_source.html">astronomy.F90</a>.</p>

</div>
</div>
<a id="ga7fb404a6aa92465cf74a3fd4a5c48d37"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga7fb404a6aa92465cf74a3fd4a5c48d37">&#9670;&nbsp;</a></span>orbital_time()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real function, public astronomy_mod::orbital_time </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structtime__manager__mod_1_1time__type.html">time_type</a>), intent(in)&#160;</td>
          <td class="paramname"><em>time</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Orbital time returns the time (1 year = 2*pi) since autumnal equinox. </p>
<p>Orbital time returns the time (1 year = 2*pi) since autumnal equinox; autumnal_eq_ref is a module variable of time_type and will have been defined by default or by a call to set_ref_date_of_ae; length_of_year is available through the time manager and is set at the value approriate for the calandar being used </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">time</td><td>time (1 year = 2*pi) since autumnal equinox </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="astronomy_8F90_source.html#l02216">2216</a> of file <a class="el" href="astronomy_8F90_source.html">astronomy.F90</a>.</p>

</div>
</div>
<a id="ga527ff37a27810731b3515a0351ffd8a5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga527ff37a27810731b3515a0351ffd8a5">&#9670;&nbsp;</a></span>r_inv_squared()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real function, private astronomy_mod::r_inv_squared </td>
          <td>(</td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>ang</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>r_inv_squared returns the inverse of the square of the earth-sun distance relative to the mean distance at angle ang in the Earth's orbit. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ang</td><td>angular position of earth in its orbit, relative to a value of 0.0 at the NH autumnal equinox, value between 0.0 and 2 * pi [radians] </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The inverse of the square of the earth-sun distance relative to the mean distance [dimensionless] </dd></dl>
<p>define the earth-sun distance (r) and then return the inverse of its square (r_inv_squared) to the calling routine.</p>

<p class="definition">Definition at line <a class="el" href="astronomy_8F90_source.html#l02040">2040</a> of file <a class="el" href="astronomy_8F90_source.html">astronomy.F90</a>.</p>

</div>
</div>
<a id="ga58ff2b69c33ae8d00c831b2b049e4573"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga58ff2b69c33ae8d00c831b2b049e4573">&#9670;&nbsp;</a></span>set_orbital_parameters()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public astronomy_mod::set_orbital_parameters </td>
          <td>(</td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>ecc_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>obliq_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>per_in</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>set_orbital_parameters saves the input values of eccentricity, obliquity and perihelion time as module variables for use by astronomy_mod. </p>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">FATAL,astronomy_mod module has not been initialized</td><td></td></tr>
    <tr><td class="paramname">FATAL,astronomy_mod ecc must be between 0 and 0.99</td><td></td></tr>
    <tr><td class="paramname">FATAL,astronomy_mod obliquity must be between -90. and 90. degrees</td><td></td></tr>
    <tr><td class="paramname">FATAL,astronomy_mod perihelion must be between 0.0 and 360. degrees</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ecc_in</td><td>Eccentricity of orbital ellipse [dimensionless] </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">obliq_in</td><td>Obliquity [degrees] </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">per_in</td><td>Longitude of perihelion with respect to autumnal equinox in northern hemisphere [degrees] </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="astronomy_8F90_source.html#l00620">620</a> of file <a class="el" href="astronomy_8F90_source.html">astronomy.F90</a>.</p>

</div>
</div>
<a id="gab0623c3af659b6b2bea0f17132597d9b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab0623c3af659b6b2bea0f17132597d9b">&#9670;&nbsp;</a></span>set_period_integer()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine astronomy_mod::set_period_integer </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>period_in</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>set_period_integer saves as the input length of the year (an integer) in a time_type module variable. </p>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">FATAL,astronomy_mod module has not been initialized</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">period_in</td><td>Length of year as a time_type </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="astronomy_8F90_source.html#l00568">568</a> of file <a class="el" href="astronomy_8F90_source.html">astronomy.F90</a>.</p>

</div>
</div>
<a id="ga77dfe2d27540f0298b3e559c1f4a7a98"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga77dfe2d27540f0298b3e559c1f4a7a98">&#9670;&nbsp;</a></span>set_period_time_type()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine astronomy_mod::set_period_time_type </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structtime__manager__mod_1_1time__type.html">time_type</a>), intent(in)&#160;</td>
          <td class="paramname"><em>period_in</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set_period_time_type saves the length of the year (input as a time_type variable) into a time_type module variable. </p>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">FATAL,astronomy_mod module has not been initialized</td><td></td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="astronomy_8F90_source.html#l00592">592</a> of file <a class="el" href="astronomy_8F90_source.html">astronomy.F90</a>.</p>

</div>
</div>
<a id="ga58c5837e3f38565db2c7901d880950f7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga58c5837e3f38565db2c7901d880950f7">&#9670;&nbsp;</a></span>set_ref_date_of_ae()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public astronomy_mod::set_ref_date_of_ae </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>day_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>month_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>year_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in), optional&#160;</td>
          <td class="paramname"><em>second_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in), optional&#160;</td>
          <td class="paramname"><em>minute_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in), optional&#160;</td>
          <td class="paramname"><em>hour_in</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>set_ref_date_of_ae provides a means of specifying the reference date of the NH autumnal equinox for a particular year. </p>
<p>set_ref_date_of_ae provides a means of specifying the reference date of the NH autumnal equinox for a particular year. It is only used if calls are made to the calandar versions of the routines <a class="el" href="interfaceastronomy__mod_1_1diurnal__solar.html" title="Calculates solar information for the given location(lat &amp; lon) and time.">diurnal_solar</a> and <a class="el" href="interfaceastronomy__mod_1_1daily__mean__solar.html" title="Calculates the daily mean solar information for a given time and latitude.">daily_mean_solar</a>. If the NOLEAP calendar is used, then the date of autumnal equinox will be the same every year. If JULIAN is used, then the date of autumnal equinox will return to the same value every 4th year.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">&lt;day_in&gt;</td><td>Day of reference autumnal equinox </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">&lt;month_in&gt;</td><td>Month of reference autumnal equinox </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">&lt;year_in&gt;</td><td>Year of reference autumnal equinox </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">&lt;second_in&gt;</td><td>OPTIONAL: Second of reference autumnal equinox </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">&lt;minute_in&gt;</td><td>OPTIONAL: Minute of reference autumnal equinox </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">&lt;hour_in&gt;</td><td>OPTIONAL: Hour of reference autumnal equinox</td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">FATAL,astronomy_mod module has not been initialized</td><td></td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="astronomy_8F90_source.html#l00720">720</a> of file <a class="el" href="astronomy_8F90_source.html">astronomy.F90</a>.</p>

</div>
</div>
<a id="gaa2cc4e0964e5251d056c4f05c4a8ddf7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa2cc4e0964e5251d056c4f05c4a8ddf7">&#9670;&nbsp;</a></span>universal_time()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real function, public astronomy_mod::universal_time </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structtime__manager__mod_1_1time__type.html">time_type</a>), intent(in)&#160;</td>
          <td class="paramname"><em>time</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>universal_time returns the time of day at longitude = 0.0 (1 day = 2*pi) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">time</td><td>Time (1 year = 2*pi) since autumnal equinox </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="astronomy_8F90_source.html#l02231">2231</a> of file <a class="el" href="astronomy_8F90_source.html">astronomy.F90</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
